window.BiggerSmaller={Models:{},Collections:{},Views:{},Routers:{},init:function(){window.pubSub=_.extend({},Backbone.Events),BiggerSmaller.pageManager=new BiggerSmaller.Views.PageManagerView,BiggerSmaller.user=new BiggerSmaller.Models.UserModel({score:0}),BiggerSmaller.app=new BiggerSmaller.Routers.AppRouter,this.gameOverView=new BiggerSmaller.Views.GameOverView({model:BiggerSmaller.user}),Backbone.history.start()}},$(document).ready(function(){"use strict";FastClick.attach(document.body),BiggerSmaller.init()});var questionsData=[{name:"ant",size:"1"},{name:"mouse",size:"2"},{name:"cat",size:"3"},{name:"dog",size:"4"},{name:"lion",size:"5"},{name:"rhino",size:"6"},{name:"elephant",size:"7"},{name:"blue whale",size:"8"}];this.JST=this.JST||{},this.JST["app/scripts/templates/gameOver.ejs"]=function(obj){obj||(obj={});{var __t,__p="";_.escape}with(obj)__p+='<h1 id="wrong-answer">WRONG ANSWER!</h1>\n<h1 id="out-of-time">OUT OF TIME!</h1>\n<p>Your scored <strong id="score">'+(null==(__t=score.score)?"":__t)+"</strong> points!</p>\n<button>PLAY AGAIN!</button>";return __p},this.JST["app/scripts/templates/question.ejs"]=function(obj){obj||(obj={});{var __t,__p="";_.escape}with(obj)__p+='\n\n<button class="animal" data-size="'+(null==(__t=animals[0].size)?"":__t)+'">\n  '+(null==(__t=animals[0].name)?"":__t)+'\n</button>\n<span class="or">\n    or\n</span>\n<button class="animal" data-size="'+(null==(__t=animals[1].size)?"":__t)+'">\n  '+(null==(__t=animals[1].name)?"":__t)+"\n</button>\n\n";return __p},this.JST["app/scripts/templates/timer.ejs"]=function(obj){obj||(obj={});{var __p="";_.escape}with(obj)__p+="<p>Your content here.</p>\n\n";return __p},this.JST["app/scripts/templates/welcome.ejs"]=function(obj){obj||(obj={});{var __p="";_.escape}with(obj)__p+="<h1>Bigger or Smaller!</h1>\n<p>Which animal is biggerest?</p>\n<button>PLAY NOW!</button>";return __p},BiggerSmaller.Models.QuestionModel=Backbone.Model.extend({initialize:function(){}}),BiggerSmaller.Collections.QuestionsCollection=Backbone.Collection.extend({model:BiggerSmaller.Models.QuestionModel,getTwoAnimals:function(){var a=_.shuffle(this.models);return[a[0].toJSON(),a[1].toJSON()]}}),BiggerSmaller.Views.PageManagerView=Backbone.View.extend({el:"#main",$pages:null,animcursor:1,pagesCount:0,current:0,isAnimating:!1,endCurrPage:!1,endNextPage:!1,animEndEventNames:{WebkitAnimation:"webkitAnimationEnd",OAnimation:"oAnimationEnd",msAnimation:"MSAnimationEnd",animation:"animationend"},animEndEventName:null,support:Modernizr.cssanimations,events:{},initialize:function(){this.setPages(),this.setAnimEndEventName(),this.$pages.each(function(){var a=$(this);a.data("originalClassList",a.attr("class"))}),this.$pages.eq(this.current).addClass("screen-current"),this.setListeners()},setListeners:function(){var a=this;pubSub.on("pageManager:nextQuestion",function(){a.nextQuestion()}),pubSub.on("pageManager:startGame",function(){a.startGame()}),pubSub.on("pageManager:welcome",function(){a.showWelcome()}),pubSub.on("pageManager:gameOver",function(){a.showGameOver()})},setPages:function(){this.$pages=this.$el.children("div.screen"),this.pagesCount=this.$pages.length},setAnimEndEventName:function(){this.animEndEventName=this.animEndEventNames[Modernizr.prefixed("animation")]},showWelcome:function(){this.current=-1,this.nextPage()},startGame:function(){this.nextPage(1)},showGameOver:function(){this.nextPage(3)},nextQuestion:function(){2===this.current?this.nextPage(1):this.nextPage()},nextPage:function(a){var b=this;if(b.isAnimating)return!1;var c=Math.floor(67*Math.random())+1;b.isAnimating=!0;var d=b.$pages.eq(b.current);a>0&&(b.current=a-1),b.current<b.pagesCount-1?++b.current:b.current=0;var e=b.$pages.eq(b.current).addClass("screen-current"),f="",g="";switch(c){case 1:f="pt-page-moveToLeft",g="pt-page-moveFromRight";break;case 2:f="pt-page-moveToRight",g="pt-page-moveFromLeft";break;case 3:f="pt-page-moveToTop",g="pt-page-moveFromBottom";break;case 4:f="pt-page-moveToBottom",g="pt-page-moveFromTop";break;case 5:f="pt-page-fade",g="pt-page-moveFromRight pt-page-ontop";break;case 6:f="pt-page-fade",g="pt-page-moveFromLeft pt-page-ontop";break;case 7:f="pt-page-fade",g="pt-page-moveFromBottom pt-page-ontop";break;case 8:f="pt-page-fade",g="pt-page-moveFromTop pt-page-ontop";break;case 9:f="pt-page-moveToLeftFade",g="pt-page-moveFromRightFade";break;case 10:f="pt-page-moveToRightFade",g="pt-page-moveFromLeftFade";break;case 11:f="pt-page-moveToTopFade",g="pt-page-moveFromBottomFade";break;case 12:f="pt-page-moveToBottomFade",g="pt-page-moveFromTopFade";break;case 13:f="pt-page-moveToLeftEasing pt-page-ontop",g="pt-page-moveFromRight";break;case 14:f="pt-page-moveToRightEasing pt-page-ontop",g="pt-page-moveFromLeft";break;case 15:f="pt-page-moveToTopEasing pt-page-ontop",g="pt-page-moveFromBottom";break;case 16:f="pt-page-moveToBottomEasing pt-page-ontop",g="pt-page-moveFromTop";break;case 17:f="pt-page-scaleDown",g="pt-page-moveFromRight pt-page-ontop";break;case 18:f="pt-page-scaleDown",g="pt-page-moveFromLeft pt-page-ontop";break;case 19:f="pt-page-scaleDown",g="pt-page-moveFromBottom pt-page-ontop";break;case 20:f="pt-page-scaleDown",g="pt-page-moveFromTop pt-page-ontop";break;case 21:f="pt-page-scaleDown",g="pt-page-scaleUpDown pt-page-delay300";break;case 22:f="pt-page-scaleDownUp",g="pt-page-scaleUp pt-page-delay300";break;case 23:f="pt-page-moveToLeft pt-page-ontop",g="pt-page-scaleUp";break;case 24:f="pt-page-moveToRight pt-page-ontop",g="pt-page-scaleUp";break;case 25:f="pt-page-moveToTop pt-page-ontop",g="pt-page-scaleUp";break;case 26:f="pt-page-moveToBottom pt-page-ontop",g="pt-page-scaleUp";break;case 27:f="pt-page-scaleDownCenter",g="pt-page-scaleUpCenter pt-page-delay400";break;case 28:f="pt-page-rotateRightSideFirst",g="pt-page-moveFromRight pt-page-delay200 pt-page-ontop";break;case 29:f="pt-page-rotateLeftSideFirst",g="pt-page-moveFromLeft pt-page-delay200 pt-page-ontop";break;case 30:f="pt-page-rotateTopSideFirst",g="pt-page-moveFromTop pt-page-delay200 pt-page-ontop";break;case 31:f="pt-page-rotateBottomSideFirst",g="pt-page-moveFromBottom pt-page-delay200 pt-page-ontop";break;case 32:f="pt-page-flipOutRight",g="pt-page-flipInLeft pt-page-delay500";break;case 33:f="pt-page-flipOutLeft",g="pt-page-flipInRight pt-page-delay500";break;case 34:f="pt-page-flipOutTop",g="pt-page-flipInBottom pt-page-delay500";break;case 35:f="pt-page-flipOutBottom",g="pt-page-flipInTop pt-page-delay500";break;case 36:f="pt-page-rotateFall pt-page-ontop",g="pt-page-scaleUp";break;case 37:f="pt-page-rotateOutNewspaper",g="pt-page-rotateInNewspaper pt-page-delay500";break;case 38:f="pt-page-rotatePushLeft",g="pt-page-moveFromRight";break;case 39:f="pt-page-rotatePushRight",g="pt-page-moveFromLeft";break;case 40:f="pt-page-rotatePushTop",g="pt-page-moveFromBottom";break;case 41:f="pt-page-rotatePushBottom",g="pt-page-moveFromTop";break;case 42:f="pt-page-rotatePushLeft",g="pt-page-rotatePullRight pt-page-delay180";break;case 43:f="pt-page-rotatePushRight",g="pt-page-rotatePullLeft pt-page-delay180";break;case 44:f="pt-page-rotatePushTop",g="pt-page-rotatePullBottom pt-page-delay180";break;case 45:f="pt-page-rotatePushBottom",g="pt-page-rotatePullTop pt-page-delay180";break;case 46:f="pt-page-rotateFoldLeft",g="pt-page-moveFromRightFade";break;case 47:f="pt-page-rotateFoldRight",g="pt-page-moveFromLeftFade";break;case 48:f="pt-page-rotateFoldTop",g="pt-page-moveFromBottomFade";break;case 49:f="pt-page-rotateFoldBottom",g="pt-page-moveFromTopFade";break;case 50:f="pt-page-moveToRightFade",g="pt-page-rotateUnfoldLeft";break;case 51:f="pt-page-moveToLeftFade",g="pt-page-rotateUnfoldRight";break;case 52:f="pt-page-moveToBottomFade",g="pt-page-rotateUnfoldTop";break;case 53:f="pt-page-moveToTopFade",g="pt-page-rotateUnfoldBottom";break;case 54:f="pt-page-rotateRoomLeftOut pt-page-ontop",g="pt-page-rotateRoomLeftIn";break;case 55:f="pt-page-rotateRoomRightOut pt-page-ontop",g="pt-page-rotateRoomRightIn";break;case 56:f="pt-page-rotateRoomTopOut pt-page-ontop",g="pt-page-rotateRoomTopIn";break;case 57:f="pt-page-rotateRoomBottomOut pt-page-ontop",g="pt-page-rotateRoomBottomIn";break;case 58:f="pt-page-rotateCubeLeftOut pt-page-ontop",g="pt-page-rotateCubeLeftIn";break;case 59:f="pt-page-rotateCubeRightOut pt-page-ontop",g="pt-page-rotateCubeRightIn";break;case 60:f="pt-page-rotateCubeTopOut pt-page-ontop",g="pt-page-rotateCubeTopIn";break;case 61:f="pt-page-rotateCubeBottomOut pt-page-ontop",g="pt-page-rotateCubeBottomIn";break;case 62:f="pt-page-rotateCarouselLeftOut pt-page-ontop",g="pt-page-rotateCarouselLeftIn";break;case 63:f="pt-page-rotateCarouselRightOut pt-page-ontop",g="pt-page-rotateCarouselRightIn";break;case 64:f="pt-page-rotateCarouselTopOut pt-page-ontop",g="pt-page-rotateCarouselTopIn";break;case 65:f="pt-page-rotateCarouselBottomOut pt-page-ontop",g="pt-page-rotateCarouselBottomIn";break;case 66:f="pt-page-rotateSidesOut",g="pt-page-rotateSidesIn pt-page-delay200";break;case 67:f="pt-page-rotateSlideOut",g="pt-page-rotateSlideIn"}d.addClass(f).on(this.animEndEventName,function(){d.off(b.animEndEventName),b.endCurrPage=!0,b.endNextPage&&b.onEndAnimation(d,e)}),e.addClass(g).on(this.animEndEventName,function(){e.off(b.animEndEventName),b.endNextPage=!0,b.endCurrPage&&b.onEndAnimation(d,e)}),this.support||this.onEndAnimation(d,e)},onEndAnimation:function(a,b){this.endCurrPage=!1,this.endNextPage=!1,this.resetPage(a,b),this.isAnimating=!1,pubSub.trigger("pageAnimation:complete",{foo:!0})},resetPage:function(a,b){a.attr("class",a.data("originalClassList")),b.attr("class",b.data("originalClassList")+" screen-current")}}),BiggerSmaller.Routers.AppRouter=Backbone.Router.extend({routes:{"":"welcome",game:"game",gameover:"gameOver"},game:function(){if(pubSub.trigger("pageManager:startGame"),!this.question1View){var a=new BiggerSmaller.Collections.QuestionsCollection(questionsData);this.timerView=new BiggerSmaller.Views.TimerView,this.question1View=new BiggerSmaller.Views.QuestionView({collection:a,el:"#question1",index:1}),this.question2View=new BiggerSmaller.Views.QuestionView({collection:a,el:"#question2",index:2})}},welcome:function(){pubSub.trigger("pageManager:welcome"),this.welcomeView||(this.welcomeView=new BiggerSmaller.Views.WelcomeView)},gameOver:function(){pubSub.trigger("pageManager:gameOver")}}),BiggerSmaller.Views.QuestionView=Backbone.View.extend({template:JST["app/scripts/templates/question.ejs"],events:{"click .animal":"determineResult"},index:0,initialize:function(){this.index=this.options.index;var a=this;pubSub.on("question:correctAnswer",function(b){b.questionIndex!==a.index&&a.render()}),this.render()},render:function(){var a=this.collection.getTwoAnimals();this.$el.html(this.template({animals:a})),this.setButtonSize()},setButtonSize:function(){if(!($(".screen").height()>400)){var a=$(".screen").height()-$(".or").outerHeight(!0)-$(".countdownbar").outerHeight(!0)-15;$(".animal").height(a/2),$(".animal").css("padding","0")}},clickedRightAnswer:function(a){var b=$(a),c=b.data().size,d=this.$el.find(".animal").not(b).data().size;return c>d?!0:!1},determineResult:function(a){this.clickedRightAnswer(a.currentTarget)?(pubSub.trigger("pageManager:nextQuestion"),pubSub.trigger("question:correctAnswer",{questionIndex:this.index})):(pubSub.trigger("gameOver:wrongAnswer"),BiggerSmaller.app.navigate("gameover",{trigger:!0}))}}),BiggerSmaller.Views.WelcomeView=Backbone.View.extend({template:JST["app/scripts/templates/welcome.ejs"],el:"#welcome",events:{"click button":"startGame"},initialize:function(){this.render()},render:function(){this.$el.html(this.template())},startGame:function(){BiggerSmaller.app.navigate("game",{trigger:!0})}}),BiggerSmaller.Models.UserModel=Backbone.Model.extend({currentScore:0,initialize:function(){this.setListeners()},setListeners:function(){var a=this;pubSub.on("question:correctAnswer",function(){a.currentScore++,a.set("score",a.currentScore)}),pubSub.on("pageManager:startGame",function(){a.currentScore=0,a.set("score",0)})}}),BiggerSmaller.Views.GameOverView=Backbone.View.extend({template:JST["app/scripts/templates/gameOver.ejs"],el:"#gameover",self:null,events:{"click button":"restart"},initialize:function(){this.render(),this.setListeners()},render:function(){this.$el.html(this.template({score:this.model.toJSON()}))},restart:function(){BiggerSmaller.app.navigate("game",{trigger:!0})},updateScore:function(){this.$el.find("#score").html(this.model.get("score"))},setListeners:function(){var a=this.$el.find("#out-of-time"),b=this.$el.find("#wrong-answer"),c=this;a.addClass("hidden"),pubSub.on("gameOver:wrongAnswer",function(){c.updateScore(),a.addClass("hidden"),b.removeClass("hidden")}),pubSub.on("gameOver:timer",function(){c.updateScore(),a.removeClass("hidden"),b.addClass("hidden")})}}),BiggerSmaller.Views.TimerView=Backbone.View.extend({template:JST["app/scripts/templates/timer.ejs"],el:"#timer",allowAnimation:!0,transitionEndEventNames:{WebkitTransition:"webkitTransitionEnd",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"},transitionEndEventName:null,support:Modernizr.cssanimations,setTransitionEndEventName:function(){this.transitionEndEventName=this.transitionEndEventNames[Modernizr.prefixed("transition")]},initialize:function(){this.setTransitionEndEventName(),this.setListeners()},render:function(){},setListeners:function(){var a=this;pubSub.on("pageManager:startGame",function(){a.allowAnimation=!0,a.stopTimer(),a.resetTimer()}),pubSub.on("pageAnimation:complete",function(){a.allowAnimation&&a.startTimer()}),pubSub.on("question:correctAnswer",function(){a.stopTimer(),a.resetTimer()}),pubSub.on("gameOver:wrongAnswer",function(){a.allowAnimation=!1,a.stopTimer(),a.resetTimer()}),pubSub.on("gameOver:timer",function(){a.allowAnimation=!1,a.stopTimer(),a.resetTimer()})},startTimer:function(){this.$el.animate({width:0},750,function(){pubSub.trigger("gameOver:timer"),BiggerSmaller.app.navigate("gameover",{trigger:!0})})},resetTimer:function(){this.$el.animate({width:"100%"},0,function(){})},stopTimer:function(){this.$el.stop()}});